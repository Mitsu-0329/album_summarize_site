<main>
  <p id="notice"></p>
  <div class="container px-5 px-sm-0">
    <div class="row">
      <div class="col-md-11">
      <h3>グループ詳細</h3><p><%= link_to "スライドショー", photo_albums_show_path, class:"btn btn-success" %></p>
        <table class="table table-hover table-inverse">
          <thead>
            <th>Id</th>
            <th>名前</th>
            <th>紹介文</th>
            <th>Family code</th>
            <th>Owner id</th>
            <th>Group image</th>
            <th>グループ編集</th>
            <th>グループ削除</th>
            <th colspan="3"></th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><%= link_to @group.id, group_path(@group) %></td>
            <td><%= @group.name %></td>
            <td><%= @group.introduction %></td>
            <td><%= @group.family_code %></td>
            <td><%= @group.owner_id %></td>
            <td>
            <%= image_tag @group.get_image(100, 100) %>
            </td>
            <td>
            <% if @group.owner_id == current_user.id %>
            <p><%= link_to "グループ編集", edit_group_path(@group.id) , class:"btn btn-success" %></p>
            <% end %>
            </td>
            <td>
            <% if @group.owner_id == current_user.id %>
            <p><%= link_to "グループ削除", group_path(@group.id), class:"text-dark", class:"btn btn-secondary", method: :delete, "data-confirm" => "本当に削除しますか？" %></p>
            <% end %>
            </td>
          </tbody>
        </table>

        <h2>Group-members</h2>
          <%= form_with url: group_group_users_path(@group), local: true do |f| %>
            <p><%= select_tag :user_id, options_from_collection_for_select(@family_users, :id, :name) %></p>
            <p><%= f.submit 'メンバー追加' %></p>
          <% end %>
        <table class="table table-hover table-inverse">
          <thead>
            <tr>
              <th>Id</th>
              <th>User name</th>
              <th>Email</th>
              <th>Family code</th>
              <th colspan="3"></th>
            </tr>
          </thead>
          <tbody>
            <% @group.users.each do |user| %>
              <tr>
                <td>
                  <%= link_to user.id, user_path(@group) %>
                </td>
                <td>
                  <%= user.name %>
                </td>
                <td>
                  <%= user.email %>
                </td>
                <td>
                  <%= user.family_code %>
                </td>
                <td>
                  <% if @group.owner_id == current_user.id %>
                  <%= link_to 'グループから削除', group_group_user_path(@group, user), method: :delete, data: {confirm: '本当に削除しますか？'} %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

      </div>
    </div>
  </div>
</main>


<div class="container">
  <div class="row no-gutters">
    <div class="col-md-7 col-sm-10 mx-2 mx-sm-auto shadow-lg rounded px-0 my-5">
      <h5 class="text-dark bg-light p-4 mb-0">グループメンバーにメールを送信</h5>
      <div class="p-3">
        <%= form_with url: send_email_group_path(@group), method: :post do |f| %>
          <div>
            <%= f.label :subject, "件名" %><br>
            <%= f.text_field :subject, class: "form-control" %>
          </div>

          <div class="mt-2">
            <%= f.label :message, "本文" %><br>
            <%= f.text_area :message, class: "form-control", rows: 5 %>
          </div>

          <div class="mt-3">
            <%= f.submit "送信", class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

